<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <title>Convert Excel to HTML Table using JavaScript</title>
  
    <script src="https://unpkg.com/read-excel-file@4.x/bundle/read-excel-file.min.js"></script>
</head>
<body>
    <div class="container">
        <h2 class="text-center mt-4 mb-4">Convert Excel to HTML Table using JavaScript</h2>
        <div class="card">
    		<div class="card-header"><b>Select Excel File</b></div>
    		<div class="card-body">
            <input type="file" id="input">
            <table class="table table-striped" id="tbl-data"></table>

    		</div>
           
    </div>
    <script>
        const input = document.getElementById('input');
        input.addEventListener('change', function(){
            readXlsxFile(input.files[0]).then(function(data){
                let i = 0;
                data.map((row, index) => {
                    if(i==0){
                        let table = document.getElementById('tbl-data');
                        generateTableHead(table, row);
                    }
                    if(i>0){
                        let table = document.getElementById('tbl-data');
                        generateTableHead(table, row);
                    }
                    i++;
                })
            })
        })
        function generateTableHead (table, data) {
            let thead = table.createTHead();
            let row = thead.insertRow();
            for (let key of data){
                let th = document.createElement('th');
                let text = document.createTextNode(key);
                th.appendChild(text);
                row.appendChild(th);
            }
        }
        function generateTableRows(table, data){
            let newRow = table.insertRow(-1);
            data.map((row, index) => {
                let newCell = newRow.insertCell();
                let newText = document.createTextNode(row);
                newCell.appendChild(newText);
            })
        }
        
    </script>
</body>
</html>